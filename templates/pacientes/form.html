{% extends "base.html" %}

{% block content %}
<h1>{% if paciente %}Editar{% else %}Novo{% endif %} Paciente</h1>

<div class="card">
    <div class="card-body">
        <form method="POST">
            <div class="row">
                <div class="col-md-8">
                    <div class="mb-3">
                        <label for="nome" class="form-label">Nome Completo *</label>
                        <input type="text" class="form-control" name="nome" required
                               value="{{ dados.nome if dados else (paciente.nome if paciente else '') }}">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="cpf" class="form-label">CPF *</label>
                        <input type="text" class="form-control" name="cpf" required
                               value="{{ dados.cpf if dados else (formatar_cpf(paciente.cpf) if paciente else '') }}">
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="data_nascimento" class="form-label">Data de Nascimento *</label>
                        <input type="date" class="form-control" name="data_nascimento" required
                               value="{{ dados.data_nascimento if dados else (paciente.data_nascimento.strftime('%Y-%m-%d') if paciente else '') }}">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="telefone" class="form-label">Telefone</label>
                        <input type="text" class="form-control" name="telefone"
                               value="{{ dados.telefone if dados else (paciente.telefone if paciente else '') }}">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="gosto_musical" class="form-label">Gosto Musical</label>
                        <input type="text" class="form-control" name="gosto_musical"
                               value="{{ dados.gosto_musical if dados else (paciente.gosto_musical if paciente else '') }}">
                    </div>
                </div>
            </div>

            <div class="mb-3">
                <label for="observacoes" class="form-label">Observações</label>
                <textarea class="form-control" name="observacoes" rows="3">{{ dados.observacoes if dados else (paciente.observacoes if paciente else '') }}</textarea>
            </div>

            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                    {% if paciente %}Atualizar{% else %}Cadastrar{% endif %}
                </button>
                {% if not paciente %}
                <button type="submit" name="anamnese" value="1" class="btn btn-success">
                    Salvar e Ir para Anamnese
                </button>
                {% endif %}
                <a href="{{ url_for('pacientes') }}" class="btn btn-secondary">Cancelar</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}